<Window
    x:Class="MicaPDF.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <Grid>
        <NavigationView x:Name="NavView"
                        IsBackButtonVisible="Collapsed"
                        IsSettingsVisible="False"
                        PaneDisplayMode="Left"
                        OpenPaneLength="280"
                        IsPaneToggleButtonVisible="True"
                        Header="">
            
            <NavigationView.MenuItems>
                <NavigationViewItem Icon="Document" Content="Viewer" Tag="viewer" IsSelected="True"/>
                <NavigationViewItem Icon="OpenFile" Content="Open File" Tag="open"/>
                <NavigationViewItemSeparator/>
                <NavigationViewItemHeader x:Name="ZoomHeaderTextBlock" Content="Zoom: 50%"/>
                <NavigationViewItem Tag="zoomin">
                    <NavigationViewItem.Icon>
                        <SymbolIcon Symbol="ZoomIn"/>
                    </NavigationViewItem.Icon>
                    <NavigationViewItem.Content>
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <TextBlock Text="Zoom In" VerticalAlignment="Center"/>
                        </StackPanel>
                    </NavigationViewItem.Content>
                </NavigationViewItem>
                <NavigationViewItem Tag="zoomout">
                    <NavigationViewItem.Icon>
                        <SymbolIcon Symbol="ZoomOut"/>
                    </NavigationViewItem.Icon>
                    <NavigationViewItem.Content>
                        <TextBlock Text="Zoom Out"/>
                    </NavigationViewItem.Content>
                </NavigationViewItem>
                <NavigationViewItem Tag="zoomreset">
                    <NavigationViewItem.Icon>
                        <FontIcon Glyph="&#xE71E;"/>
                    </NavigationViewItem.Icon>
                    <NavigationViewItem.Content>
                        <TextBlock Text="Reset Zoom (50%)"/>
                    </NavigationViewItem.Content>
                </NavigationViewItem>
                <NavigationViewItemSeparator/>
                <NavigationViewItemHeader x:Name="PageHeaderTextBlock" Content="Page 1 / 1"/>
                <NavigationViewItem Icon="Next" Content="Next Page" Tag="nextpage"/>
                <NavigationViewItem Icon="Previous" Content="Previous Page" Tag="prevpage"/>
                <NavigationViewItem Tag="doublepagemode">
                    <NavigationViewItem.Icon>
                        <FontIcon Glyph="&#xE89A;"/>
                    </NavigationViewItem.Icon>
                    <NavigationViewItem.Content>
                        <TextBlock x:Name="DoublePageModeTextBlock" Text="Enable Double Page"/>
                    </NavigationViewItem.Content>
                </NavigationViewItem>
                <NavigationViewItemSeparator/>
                <NavigationViewItem Tag="selectmode">
                    <NavigationViewItem.Icon>
                        <FontIcon Glyph="&#xE962;"/>
                    </NavigationViewItem.Icon>
                    <NavigationViewItem.Content>
                        <TextBlock Text="Select"/>
                    </NavigationViewItem.Content>
                </NavigationViewItem>
                <NavigationViewItem Tag="penmode">
                    <NavigationViewItem.Icon>
                        <FontIcon Glyph="&#xE76D;"/>
                    </NavigationViewItem.Icon>
                    <NavigationViewItem.Content>
                        <TextBlock Text="Pen"/>
                    </NavigationViewItem.Content>
                </NavigationViewItem>
                <NavigationViewItem Tag="eraser">
                    <NavigationViewItem.Icon>
                        <FontIcon Glyph="&#xE75C;"/>
                    </NavigationViewItem.Icon>
                    <NavigationViewItem.Content>
                        <TextBlock Text="Eraser"/>
                    </NavigationViewItem.Content>
                </NavigationViewItem>
                <NavigationViewItem Tag="clearink">
                    <NavigationViewItem.Icon>
                        <FontIcon Glyph="&#xE74D;"/>
                    </NavigationViewItem.Icon>
                    <NavigationViewItem.Content>
                        <TextBlock Text="Clear All Annotations"/>
                    </NavigationViewItem.Content>
                </NavigationViewItem>
                <NavigationViewItemSeparator/>
                <NavigationViewItem Tag="savewithannotations">
                    <NavigationViewItem.Icon>
                        <SymbolIcon Symbol="Save"/>
                    </NavigationViewItem.Icon>
                    <NavigationViewItem.Content>
                        <TextBlock Text="Save with Annotations"/>
                    </NavigationViewItem.Content>
                </NavigationViewItem>
            </NavigationView.MenuItems>

            <NavigationView.PaneFooter>
                <NavigationViewItem Content="Go to page..." Tag="gotopage" Margin="0,0,0,8" Tapped="GoToPageItem_Tapped">
                    <NavigationViewItem.Icon>
                        <FontIcon Glyph="&#xE8CB;"/>
                    </NavigationViewItem.Icon>
                </NavigationViewItem>
            </NavigationView.PaneFooter>

            <Grid>
                <!-- Dialog for go to page -->
                <ContentDialog x:Name="GoToPageDialog"
                              Title="Go to page"
                              PrimaryButtonText="Go"
                              CloseButtonText="Cancel"
                              DefaultButton="Primary"
                              PrimaryButtonClick="GoToPageDialog_PrimaryButtonClick">
                    <StackPanel Spacing="12">
                        <TextBlock Text="Enter the page number:" TextWrapping="Wrap"/>
                        <NumberBox x:Name="PageNumberBox" 
                                  PlaceholderText="Page number"
                                  SpinButtonPlacementMode="Hidden"
                                  Minimum="1"
                                  Value="1"
                                  LargeChange="1"
                                  SmallChange="1"
                                  KeyDown="PageNumberBox_KeyDown"/>
                    </StackPanel>
                </ContentDialog>

                <!-- Hidden elements for code -->
                <StackPanel Visibility="Collapsed">
                    <TextBlock x:Name="FileNameTextBlock"/>
                    <TextBlock x:Name="StatusTextBlock"/>
                    <TextBlock x:Name="PageInfoTextBlock"/>
                    <TextBlock x:Name="ZoomLevelTextBlock"/>
                </StackPanel>
                
                <!-- Area contenuto principale -->
                <Grid>
                    <!-- Spazio per titlebar -->
                    <Grid.RowDefinitions>
                        <RowDefinition Height="24"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Nome file nella titlebar -->
                    <TextBlock x:Name="TitleBarFileName"
                              Grid.Row="0"
                              Text=""
                              FontSize="12"
                              VerticalAlignment="Center"
                              HorizontalAlignment="Center"
                              Opacity="0.8"
                              Margin="48,0"/>
                    
                    <!-- Visualizzatore PDF -->
                    <Border x:Name="ViewerPanel" 
                            Grid.Row="1"
                            Background="{ThemeResource LayerFillColorDefaultBrush}"
                            CornerRadius="8"
                            Margin="8"
                            AllowDrop="True"
                            DragOver="ViewerPanel_DragOver"
                            Drop="ViewerPanel_Drop">
                        
                        <Grid>
                            <ScrollViewer x:Name="PdfScrollViewer"
                                        HorizontalScrollBarVisibility="Auto"
                                        VerticalScrollBarVisibility="Auto"
                                        ZoomMode="Enabled"
                                        MinZoomFactor="0.5"
                                        MaxZoomFactor="5.0"
                                        HorizontalScrollMode="Enabled"
                                        VerticalScrollMode="Enabled"
                                        IsHorizontalRailEnabled="False"
                                        IsVerticalRailEnabled="False"
                                        ManipulationMode="All">
                                <Grid x:Name="PdfContainer" 
                                      HorizontalAlignment="Center" 
                                      VerticalAlignment="Center"
                                      Padding="32">
                                    
                                    <!-- Single page view -->
                                    <Grid x:Name="SinglePageContainer">
                                        <Image x:Name="PdfImage" 
                                               Stretch="Uniform"
                                               HorizontalAlignment="Center"
                                               VerticalAlignment="Center"/>
                                        
                                        <!-- Canvas for pen drawing overlay -->
                                        <Canvas x:Name="PdfInkCanvas"
                                               HorizontalAlignment="Stretch"
                                               VerticalAlignment="Stretch"
                                               Background="Transparent"
                                               PointerPressed="InkCanvas_PointerPressed"
                                               PointerMoved="InkCanvas_PointerMoved"
                                               PointerReleased="InkCanvas_PointerReleased"/>
                                    </Grid>
                                    
                                    <!-- Double page view -->
                                    <StackPanel x:Name="DoublePageContainer" 
                                                Orientation="Horizontal" 
                                                Spacing="16"
                                                Visibility="Collapsed">
                                        <Grid>
                                            <Image x:Name="PdfImageLeft" 
                                                   Stretch="Uniform"
                                                   HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"/>
                                            
                                            <Canvas x:Name="PdfInkCanvasLeft"
                                                   HorizontalAlignment="Stretch"
                                                   VerticalAlignment="Stretch"
                                                   Background="Transparent"
                                                   PointerPressed="InkCanvas_PointerPressed"
                                                   PointerMoved="InkCanvas_PointerMoved"
                                                   PointerReleased="InkCanvas_PointerReleased"/>
                                        </Grid>
                                        
                                        <Grid>
                                            <Image x:Name="PdfImageRight" 
                                                   Stretch="Uniform"
                                                   HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"/>
                                            
                                            <Canvas x:Name="PdfInkCanvasRight"
                                                   HorizontalAlignment="Stretch"
                                                   VerticalAlignment="Stretch"
                                                   Background="Transparent"
                                                   PointerPressed="InkCanvas_PointerPressed"
                                                   PointerMoved="InkCanvas_PointerMoved"
                                                   PointerReleased="InkCanvas_PointerReleased"/>
                                        </Grid>
                                    </StackPanel>
                                </Grid>
                            </ScrollViewer>

                            <!-- Welcome screen stile Store -->
                            <Grid x:Name="WelcomePanel" Padding="48">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <StackPanel Grid.Row="1" 
                                           HorizontalAlignment="Center" 
                                           VerticalAlignment="Center"
                                           Spacing="24"
                                           MaxWidth="600">
                                    
                                    <!-- Icona hero -->
                                    <Viewbox Width="120" Height="120">
                                        <SymbolIcon Symbol="Document"/>
                                    </Viewbox>

                                    <!-- Titolo e descrizione -->
                                    <StackPanel Spacing="12" HorizontalAlignment="Center">
                                        <TextBlock Text="Welcome to MicaPDF" 
                                                  FontSize="28" 
                                                  FontWeight="Bold"
                                                  HorizontalAlignment="Center"
                                                  TextWrapping="Wrap"/>
                                        <TextBlock Text="Open a document to start viewing with modern interface and translucent Mica background" 
                                                  FontSize="14" 
                                                  Opacity="0.7"
                                                  TextAlignment="Center"
                                                  TextWrapping="Wrap"
                                                  MaxWidth="400"/>
                                    </StackPanel>

                                    <!-- Pulsante azione principale -->
                                    <Button Click="OpenFileButton_Click"
                                           HorizontalAlignment="Center"
                                           Style="{StaticResource AccentButtonStyle}"
                                           Padding="32,12">
                                        <StackPanel Orientation="Horizontal" Spacing="12">
                                            <SymbolIcon Symbol="OpenFile"/>
                                            <TextBlock Text="Browse and open a PDF" FontSize="16"/>
                                        </StackPanel>
                                    </Button>

                                    <!-- Loading bar -->
                                    <ProgressBar x:Name="LoadingProgressBar"
                                                IsIndeterminate="True"
                                                Visibility="Collapsed"
                                                Margin="0,8,0,0"/>

                                    <!-- Feature cards -->
                                    <Grid Margin="0,32,0,0" ColumnSpacing="16" RowSpacing="16">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>

                                        <!-- Card 1 -->
                                        <Border Grid.Column="0" 
                                               Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                               CornerRadius="8"
                                               Padding="16"
                                               BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                               BorderThickness="1">
                                            <StackPanel Spacing="8" HorizontalAlignment="Center">
                                                <SymbolIcon Symbol="View" Width="32" Height="32" HorizontalAlignment="Center"/>
                                                <TextBlock Text="High Quality" FontWeight="SemiBold" HorizontalAlignment="Center"/>
                                                <TextBlock Text="High-definition rendering" 
                                                          FontSize="12" 
                                                          Opacity="0.7"
                                                          TextWrapping="Wrap"
                                                          TextAlignment="Center"
                                                          HorizontalAlignment="Center"/>
                                            </StackPanel>
                                        </Border>

                                        <!-- Card 2 -->
                                        <Border Grid.Column="1" 
                                               Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                               CornerRadius="8"
                                               Padding="16"
                                               BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                               BorderThickness="1">
                                            <StackPanel Spacing="8" HorizontalAlignment="Center">
                                                <SymbolIcon Symbol="ZoomIn" Width="32" Height="32" HorizontalAlignment="Center"/>
                                                <TextBlock Text="Advanced Zoom" FontWeight="SemiBold" HorizontalAlignment="Center"/>
                                                <TextBlock Text="Up to 500% magnification" 
                                                          FontSize="12" 
                                                          Opacity="0.7"
                                                          TextWrapping="Wrap"
                                                          TextAlignment="Center"
                                                          HorizontalAlignment="Center"/>
                                            </StackPanel>
                                        </Border>

                                        <!-- Card 3 -->
                                        <Border Grid.Column="2" 
                                               Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                               CornerRadius="8"
                                               Padding="16"
                                               BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                               BorderThickness="1">
                                            <StackPanel Spacing="8" HorizontalAlignment="Center">
                                                <FontIcon Glyph="&#xE91B;" FontSize="32" HorizontalAlignment="Center"/>
                                                <TextBlock Text="Mica Design" FontWeight="SemiBold" HorizontalAlignment="Center"/>
                                                <TextBlock Text="Modern translucent background" 
                                                          FontSize="12" 
                                                          Opacity="0.7"
                                                          TextWrapping="Wrap"
                                                          TextAlignment="Center"
                                                          HorizontalAlignment="Center"/>
                                            </StackPanel>
                                        </Border>
                                    </Grid>
                                </StackPanel>
                            </Grid>
                        </Grid>
                    </Border>
                </Grid>
            </Grid>
        </NavigationView>
    </Grid>
</Window>
